package services.lz;

import org.junit.jupiter.api.Test;
import services.Utils;

import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.util.logging.Level;
import java.util.logging.Logger;

import static org.junit.jupiter.api.Assertions.*;
import static services.Utils.h;
import static services.Utils.x;

class LzDecompressorTest {

    private final static String INPUT_ROM = "D:\\git\\dokapon-english\\roms\\2023\\Dokapon 3-2-1 - Arashi o Yobu Yuujou (Japan).sfc";
    private final static String OUTPUT_ROM = "D:\\git\\dokapon-english\\roms\\2023\\decomp.data";

    byte[] loadRom() {
        try {
            return Files.readAllBytes(new File(INPUT_ROM).toPath());
        } catch (IOException ex) {
            Logger.getLogger(LzDecompressorTest.class.getName()).log(Level.SEVERE, null, ex);
        }
        return null;
    }

    byte[] loadRom(String input) {
        try {
            return Files.readAllBytes(new File(input).toPath());
        } catch (IOException ex) {
            Logger.getLogger(LzDecompressorTest.class.getName()).log(Level.SEVERE, null, ex);
        }
        return null;
    }

    @Test
    void testDecompressMapTiles() {
        //byte[] data = loadRom("D:\\git\\dokapon-english\\roms\\2023\\Dokapon 3-2-1 - English.sfc");
        byte[] data = loadRom(INPUT_ROM);
        int offset = x("16B4AC");
        LzDecompressor decompressor = new LzDecompressor();
        decompressor.decompressData(data, offset,
                "D:\\git\\dokapon-english\\dokapon-gen\\src\\main\\resources\\data\\trash\\"+h(offset)+".data"
        );
    }
    
    @Test
    void testDecompress() {
        byte[] data = loadRom();
        int offset = x("77515");
        LzDecompressor decompressor = new LzDecompressor();
        decompressor.decompressData(data, offset, 
                "D:\\git\\dokapon-english\\dokapon-gen\\src\\main\\resources\\data\\trash\\"+h(offset)+".data"
                );
    }

    @Test
    void testIntroQuoteAlgo8() {
        String expectedDataHex = "04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 02 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 03 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 02 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 03 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 02 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 03 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 02 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 03 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 02 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 03 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 02 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 03 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 02 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 03 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 02 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 03 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 02 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 03 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 01 00 02 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 03 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 01 00 02 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 03 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 01 00 02 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 03 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 01 00 02 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 03 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 01 00 02 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 03 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00";
        byte[] data = loadRom();
        int offset = x("1177E1");
        LzDecompressor decompressor = new LzDecompressor();
        decompressor.decompressData(data, offset, OUTPUT_ROM);
        byte[] decompressedData = decompressor.getDecompressedData();
        byte[] expectedData = Utils.hexStringToByteArray(expectedDataHex);
        System.out.println("Expected\t"+expectedDataHex);
        System.out.println("Actual  \t"+Utils.bytesToHex(decompressedData));
        assertArrayEquals(expectedData, decompressedData);
    }
    
    @Test
    void testIntroQuoteAlgo5() {
        String expectedDataHex = "00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF F8 FF 80 FF 80 FF 80 FF 80 FF 80 FF 80 FF 80 FF 01 FF 01 FF 01 FF 7F FF 02 FF 02 FF 02 FF 07 FF 00 FF 00 FF 00 FF FF FF 00 FF 00 FF 00 FF F8 FF 10 FF 10 FF 11 FF 10 FF 54 FF 54 FF 55 FF 50 FF 10 FF 10 FF FF FF 10 FF FE FF 10 FF FF FF 00 FF 00 FF 00 FF 20 FF 10 FF 12 FF 11 FF 10 FF 20 FF 00 FF 20 FF 10 FF 12 FF 1C FF F0 FF 10 FF 10 FF 00 FF 00 FF 00 FF 1F FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF FC FF 04 FF 04 FF 04 FF 04 FF 00 FF 00 FF 00 FF 00 FF 3F FF 00 FF 00 FF 04 FF 02 FF 91 FF 88 FF 80 FF FE FF 80 FF 80 FF 90 FF 00 FF 00 FF 00 FF 04 FF 04 FF 04 FF 04 FF 04 FF 00 FF 00 FF 20 FF 20 FF 20 FF 20 FF 21 FF 21 FF 00 FF 04 FF 04 FF 04 FF 04 FF 06 FF 05 FF 04 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 80 FF 60 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 80 FF 80 FF 80 FF 80 FF 80 FF 80 FF 80 FF 80 FF 04 FF 05 FF 08 FF 08 FF 10 FF 10 FF 20 FF 43 FF 08 FF 08 FF 90 FF 50 FF 20 FF 50 FF 8C FF 03 FF 50 FF 10 FF 10 FF 10 FF 10 FF 10 FF 10 FF 10 FF FE FF 82 FF FE FF 82 FF FE FF 82 FF 82 FF 8E FF 20 FF 20 FF 20 FF 28 FF 29 FF 31 FF 10 FF 00 FF 10 FF 08 FF 08 FF F8 FF 0C FF 0A FF F0 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 1F FF 00 FF 00 FF 04 FF 04 FF 04 FF 04 FF 04 FF FC FF 00 FF 00 FF 04 FF 08 FF 08 FF 10 FF 10 FF 20 FF 00 FF 00 FF 90 FF 88 FF 88 FF 84 FF 84 FF 82 FF 80 FF 00 FF 04 FF 04 FF 08 FF 08 FF 10 FF 20 FF 40 FF 00 FF 21 FF 22 FF 22 FF 24 FF 28 FF 10 FF 00 FF 00 FF 04 FF 04 FF 04 FF 04 FF 04 FF 04 FF 04 FF 00 FF 10 FF 08 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 01 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 80 FF 80 FF 84 FF F8 FF 80 FF 80 FF 00 FF 08 FF 04 FF 04 FF 09 FF 09 FF 0A FF 0A FF 00 FF 00 FF 60 FF 90 FF 08 FF 08 FF 08 FF 08 FF 00 FF 02 FF 01 FF 01 FF 11 FF 0F FF 02 FF 12 FF 00 FF 00 FF 00 FF 00 FF 00 FF C0 FF 08 FF 04 FF 00 FF 7F FF 01 FF 01 FF 3F FF 20 FF 40 FF 7F FF 00 FF 7F FF 01 FF 01 FF 3F FF 20 FF 40 FF 7F FF 00 FF 00 FF 00 FF 00 FF 00 FF 01 FF 06 FF 08 FF 00 FF 20 FF 10 FF 20 FF 40 FF 80 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 1F FF 20 FF 20 FF 18 FF 07 FF 00 FF 40 FF 40 FF C0 FF 70 FF 4C FF 82 FF 00 FF 00 FF 0A FF 0C FF 04 FF 00 FF 00 FF 00 FF 03 FF 00 FF 08 FF 08 FF 10 FF 10 FF 20 FF C0 FF 00 FF 00 FF 22 FF 1F FF 04 FF 04 FF 04 FF 02 FF 01 FF 00 FF 42 FF 82 FF 02 FF 04 FF 04 FF 08 FF F0 FF 00 FF 01 FF 21 FF 11 FF 05 FF 19 FF 61 FF 01 FF 1E FF 01 FF 21 FF 11 FF 05 FF 19 FF 61 FF 01 FF 1E FF 08 FF 06 FF 01 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 80 FF 40 FF 20 FF 10 FF 08 FF 08 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 04 FF 04 FF 04 FF 04 FF 06 FF 05 FF 04 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 80 FF 60 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 20 FF 1F FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 7E FF 80 FF 00 FF 08 FF 08 FF 08 FF 08 FF 08 FF 08 FF 08 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 02 FF 02 FF 00 FF 00 FF 00 FF 00 FF 00 FF 3F FF 00 FF 00 FF 00 FF 40 FF 40 FF 40 FF 40 FF FE FF 40 FF 40 FF 00 FF 10 FF 10 FF 1F FF 00 FF 00 FF 7F FF 02 FF 80 FF 84 FF 84 FF FC FF 00 FF 00 FF FF FF 00 FF 00 FF 01 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 80 FF 80 FF 84 FF F8 FF 80 FF 80 FF 00 FF 08 FF 04 FF 04 FF 09 FF 09 FF 0A FF 0A FF 00 FF 00 FF 60 FF 90 FF 08 FF 08 FF 08 FF 08 FF 00 FF 02 FF 01 FF 01 FF 11 FF 0F FF 02 FF 12 FF 00 FF 00 FF 00 FF 00 FF 00 FF C0 FF 08 FF 04 FF 04 FF 04 FF 04 FF 04 FF 04 FF 04 FF 04 FF 00 FF 10 FF 08 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 08 FF 08 FF 08 FF 08 FF 08 FF 09 FF 0E FF 00 FF 04 FF 04 FF 08 FF 10 FF 20 FF C0 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 01 FF 06 FF 18 FF 00 FF 40 FF 80 FF 80 FF 80 FF 00 FF 00 FF 00 FF 00 FF 04 FF 04 FF 0F FF 14 FF 64 FF 04 FF 04 FF 07 FF 00 FF 00 FF FC FF 04 FF 04 FF 04 FF 04 FF FC FF 00 FF 00 FF 1F FF 20 FF 20 FF 18 FF 07 FF 00 FF 40 FF 40 FF C0 FF 70 FF 4C FF 82 FF 00 FF 00 FF 0A FF 0C FF 04 FF 00 FF 00 FF 00 FF 03 FF 00 FF 08 FF 08 FF 10 FF 10 FF 20 FF C0 FF 00 FF 00 FF 22 FF 1F FF 04 FF 04 FF 04 FF 02 FF 01 FF 00 FF 42 FF 82 FF 02 FF 04 FF 04 FF 08 FF F0 FF 00 FF 20 FF 11 FF 08 FF 00 FF 40 FF 21 FF 11 FF 01 FF 10 FF 12 FF 92 FF 94 FF 10 FF FE FF 02 FF 02 FF 02 FF 01 FF 00 FF 00 FF 11 FF 0E FF 00 FF 00 FF 00 FF E0 FF 40 FF 00 FF F0 FF 20 FF 40 FF 80 FF 00 FF 01 FF 00 FF 10 FF 08 FF 09 FF 4E FF 38 FF 00 FF 80 FF 40 FF 00 FF 78 FF 84 FF 02 FF 02 FF 00 FF 01 FF 00 FF 40 FF 3F FF 00 FF 00 FF 07 FF 00 FF 80 FF 40 FF 7E FF C0 FF 40 FF 40 FF C0 FF 00 FF 00 FF 20 FF 10 FF 10 FF 20 FF 20 FF 20 FF 00 FF 00 FF 00 FF 10 FF 08 FF 04 FF 04 FF 02 FF 01 FF 01 FF 01 FF 01 FF 01 FF 01 FF 01 FF 01 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 01 FF 09 FF 09 FF 11 FF 11 FF 21 FF 21 FF 41 FF FE FF 02 FF 02 FF FE FF 02 FF 02 FF 02 FF 0E FF 01 FF 01 FF 02 FF 04 FF 08 FF 10 FF 20 FF 00 FF 00 FF C0 FF 20 FF 20 FF 20 FF 20 FF 1E FF 00 FF 04 FF 04 FF 04 FF 02 FF 02 FF 02 FF 02 FF 00 FF 02 FF 84 FF 78 FF 00 FF 00 FF 00 FF 00 FF 00 FF 08 FF 08 FF 07 FF 00 FF 00 FF 03 FF 0C FF 00 FF 40 FF 40 FF C0 FF 40 FF 80 FF 00 FF 00 FF 00 FF 20 FF 22 FF 24 FF 14 FF 18 FF 0C FF 00 FF 00 FF 02 FF 1A FF 06 FF 02 FF 00 FF 00 FF 00 FF 00 FF 01 FF 01 FF 01 FF 01 FF 01 FF 01 FF 01 FF 1F FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 04 FF 04 FF 04 FF 04 FF 06 FF 05 FF 04 FF 00 FF 08 FF 04 FF 20 FF 10 FF 00 FF 80 FF 60 FF 00 FF 01 FF 01 FF 01 FF 3F FF 01 FF 01 FF 01 FF 00 FF 00 FF 00 FF 00 FF FC FF 04 FF 04 FF 04 FF 00 FF 00 FF 00 FF 00 FF 3F FF 00 FF 00 FF 04 FF 00 FF 86 FF 89 FF 89 FF FE FF 80 FF 80 FF 90 FF 00 FF 00 FF 18 FF 06 FF 01 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 02 FF 02 FF 02 FF 00 FF 03 FF 0C FF 10 FF 10 FF 00 FF 00 FF 03 FF 00 FF E0 FF 18 FF 04 FF 04 FF 04 FF 18 FF E0 FF 08 FF 08 FF 08 FF 08 FF 08 FF 7F FF 08 FF 08 FF 88 FF 88 FF 88 FF 88 FF 88 FF FF FF 88 FF 88 FF 02 FF 7F FF 02 FF 00 FF 1F FF 00 FF 00 FF 7F FF 20 FF FF FF 20 FF 84 FF F8 FF 90 FF A0 FF FF FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 04 FF 04 FF 04 FF 04 FF 04 FF 04 FF 04 FF 00 FF 10 FF 08 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 02 FF 02 FF 02 FF 04 FF 04 FF 08 FF 30 FF 00 FF 04 FF 04 FF 04 FF 04 FF 04 FF 04 FF 38 FF 00 FF 04 FF 08 FF 08 FF 10 FF 10 FF 20 FF 00 FF 00 FF 90 FF 88 FF 88 FF 84 FF 84 FF 82 FF 80 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 01 FF 0E FF 00 FF 04 FF 04 FF 08 FF 10 FF 60 FF 80 FF 00 FF 00 FF 00 FF 00 FF 00 FF 10 FF 10 FF 0C FF 03 FF 00 FF 18 FF 04 FF 04 FF 04 FF 04 FF 18 FF E0 FF 00 FF 08 FF 08 FF 08 FF 08 FF 08 FF 08 FF 08 FF 0F FF 88 FF 88 FF 88 FF F8 FF 00 FF 00 FF 00 FF FF FF 01 FF 07 FF 1C FF 64 FF 07 FF 04 FF 04 FF 07 FF 00 FF FC FF 04 FF 04 FF FC FF 04 FF 04 FF FC FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF F8 FF 80 FF 80 FF 80 FF 80 FF 80 FF 80 FF 80 FF 00 FF 10 FF 10 FF 10 FF 10 FF 10 FF 1F FF 10 FF 02 FF 01 FF 08 FF 04 FF 00 FF F0 FF 00 FF 00 FF 00 FF 10 FF 10 FF 10 FF 10 FF 10 FF 1F FF 10 FF 02 FF 01 FF 08 FF 04 FF 00 FF F0 FF 00 FF 00 FF 00 FF 00 FF 00 FF 04 FF 04 FF 04 FF 04 FF 04 FF 00 FF 00 FF 20 FF 20 FF 20 FF 20 FF 21 FF 21 FF 00 FF 00 FF 3F FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF FE FF 02 FF 02 FF 04 FF 04 FF 08 FF 00 FF 00 FF 00 FF 1F FF 10 FF 10 FF 10 FF 10 FF 00 FF 80 FF 80 FF FC FF 04 FF 04 FF 04 FF 04 FF 00 FF 00 FF 18 FF 06 FF 01 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 02 FF 02 FF 02 FF 00 FF 00 FF 1F FF 00 FF 00 FF 00 FF 3F FF 00 FF 00 FF 00 FF FC FF 00 FF 00 FF 00 FF FE FF 80 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 80 FF 80 FF 80 FF 80 FF 80 FF 80 FF 80 FF 80 FF 10 FF 10 FF 10 FF 10 FF 10 FF 0F FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF FC FF 00 FF 00 FF 10 FF 10 FF 10 FF 10 FF 10 FF 0F FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF FC FF 00 FF 00 FF 04 FF 04 FF 08 FF 08 FF 10 FF 20 FF 40 FF 00 FF 21 FF 22 FF 22 FF 24 FF 28 FF 10 FF 00 FF 00 FF 0C FF 03 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 10 FF 60 FF 80 FF 40 FF 20 FF 10 FF 00 FF 00 FF 10 FF 00 FF 00 FF 00 FF 00 FF 00 FF 03 FF 00 FF 04 FF 08 FF 08 FF 10 FF 20 FF C0 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 01 FF 0E FF 00 FF 04 FF 04 FF 08 FF 10 FF 60 FF 80 FF 00 FF 00 FF 00 FF 00 FF 00 FF 01 FF 01 FF 02 FF 1C FF 00 FF 80 FF 80 FF 80 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 18 FF 06 FF 01 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 02 FF 02 FF 02 FF 00 FF 00 FF 01 FF 06 FF 08 FF 10 FF 10 FF 21 FF 00 FF 00 FF E0 FF 98 FF 84 FF 82 FF 82 FF 02 FF 02 FF 02 FF 3F FF 02 FF 02 FF 7F FF 00 FF 1F FF 20 FF 20 FF FE FF 20 FF 20 FF FF FF 80 FF FC FF 00 FF 1F FF 10 FF 10 FF 1F FF 10 FF 11 FF 7E FF 30 FF C0 FF 40 FF 40 FF FF FF 20 FF D1 FF 0D FF 01 FF 01 FF 01 FF 01 FF 01 FF 01 FF 01 FF 01 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 01 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 80 FF 80 FF 84 FF F8 FF 80 FF 80 FF 00 FF 08 FF 04 FF 04 FF 09 FF 09 FF 0A FF 0A FF 00 FF 00 FF 60 FF 90 FF 08 FF 08 FF 08 FF 08 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 01 FF 0E FF 00 FF 04 FF 04 FF 08 FF 10 FF 60 FF 80 FF 00 FF 00 FF 21 FF 21 FF 22 FF 12 FF 0C FF 00 FF 00 FF 00 FF 02 FF 02 FF 04 FF 04 FF 18 FF E0 FF 00 FF 00 FF 10 FF 10 FF 1F FF 10 FF 10 FF 1F FF 04 FF 38 FF 84 FF 84 FF FC FF 84 FF 84 FF FC FF 10 FF 0E FF 00 FF 0F FF 08 FF 08 FF 0F FF 08 FF 08 FF 0F FF 03 FF F8 FF 08 FF 08 FF F8 FF 08 FF 08 FF F8 FF 01 FF 01 FF 01 FF 01 FF 01 FF 01 FF 01 FF 1F FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 1F FF 20 FF 20 FF 18 FF 07 FF 00 FF 40 FF 40 FF C0 FF 70 FF 4C FF 82 FF 00 FF 00 FF 0A FF 0C FF 04 FF 00 FF 00 FF 00 FF 03 FF 00 FF 08 FF 08 FF 10 FF 10 FF 20 FF C0 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF 00 FF";
        byte[] data = loadRom();
        int offset = x("112D22");
        LzDecompressor decompressor = new LzDecompressor();
        decompressor.decompressData(data, offset, OUTPUT_ROM);
        byte[] decompressedData = decompressor.getDecompressedData();
        byte[] expectedData = Utils.hexStringToByteArray(expectedDataHex);
        System.out.println("Expected\t"+expectedDataHex);
        System.out.println("Actual  \t"+Utils.bytesToHex(decompressedData));
        assertArrayEquals(expectedData, decompressedData);
    }
    
    @Test
    void decompressData() {
        String data = "E0 0A 37 03 68 00 0F 00 4A 00 01 04 00 02 02 04 40 04 DF 01 00 00 0A 0A 05 05 04 00 00 FE FE 08 02 00 10 10 C3 1F 02 77 00 40 40 3F 3F 5F 01 99 06 28 C1 C1 7F 01 80 04 00 00 00 10 12 10 08 08 FF 01 7F 7F 31 01 FF 30 FF 04 02 00 FD 01 20 20 91 91 03 41 41 2F 2F E1 E1 93 0C FD 03 00 1A 1A 15 15 10 10 FF FF 70 10 04 00 FF 05 53 10 06 06 1A 1A 08 62 62 02 02 BF 01 20 20 C3 64 C3 5F 01 3B 00 82 82 F1 13 04 04 C9 FF 0B 53 0B 1E 1E D3 0B 06 06 BD 03 10 FE FE 82 00 00 FE FE 88 88 4A AA 00 00 BE BE BD 05 02 02 00 1F 73 1F 75 00 BD 07 73 0D FE FE 75 00 FF 07 0B 04 04 1F 1F B3 13 0A 00 00 BD 0B 00 44 44 48 48 FE FE 50 50 06 D0 D0 7C 7C 50 00 00 BF 0D 00 19 00 0F 0F 3F 01 59 00 FC FC 3F 01 E1 BD 1F 3F 01 F5 0B 20 20 40 40 D1 1F C3 0F 00 F5 0F 03 03 0C 0C 9F 01 B3 00 03 08 08 1C 1C E4 E4 7F 21 F7 17 F3 7F 2B FF 15 7F 1F 59 00 03 03 3F 01 F7 17 33 60 60 DF 0B 77 00 1C 1C 33 36 9F 01 80 B3 00 88 88 CA CA 4A 4A 7E 7E 7E 9F 01 F7 1F 7F 25 FD 1F FF 0D F7 3B 15 1F 15 17 17 FF 07 95 00 53 1F FF 07 77 00 F3 3F 27 1D 2C 3F 01 59 00 07 07 D1 07 31 24 20 03 03 7F 16 40 40 FC FC 10 12 10 A0 A0 51 04 F8 F8 7F 0E 00 00 00 0D 0D 03 03 01 01 03 18 03 0D 0D 9F 28 31 47 F6 F6 18 00 18 F0 F0 18 18 F6 F6 40 40 40 BF 08 08 08 0F 0F 12 12 00 04 04 0F 0F 08 08 0B 0B 80 FF 05 20 20 BE BE 48 48 10 01 10 FC FC 04 04 F4 F4 7F 24 09 04 04 02 02 51 07 07 07 DF 07 80 F5 2B F8 F8 80 80 F0 F0 80 73 80 71 00 1F 02 13 14 07 07 F1 4B 51 04 C9 DF 4F F1 33 F0 F0 91 1C F0 F0 BF 37 F1 31 2E 93 4F 9F 18 31 13 80 80 88 00 00 3F 90 90 71 04 FF 07 31 17 11 34 9F 03 F5 03 99 91 5D F8 F8 9F 01 17 62 02 02 FF 37 80 95 00 E0 E0 50 50 48 48 46 61 46 9F 01 B3 00 0B 0B 0A 0A 7F 17 81 77 00 F4 F4 14 14 F4 F4 FF 05 CC D7 27 B1 59 18 18 9F 01 B5 47 40 40 33 30 30 FF 03 1B 58 09 09 7F 01 D5 67 3F 90 90 F1 13 9F 01 DD 69 0F 00 F3 47 91 71 39 7F 7F D3 69 B3 6A 0F 00 C0 C0 73 76 30 E6 E6 BF 01 95 00 3C 3C C8 C8 3E 90 90 7F 01 33 75 9F 05 B7 05 31 01 C1 18 C1 46 46 7F 54 31 79 40 40 7C 1C 7C C4 C4 7F 50 F7 69 B1 31 10 10 1E 68 68 05 00 00 FF 05 D1 0B 51 04 80 1F 80 84 84 7F 24 9F 60 0F 00 57 44 7F 48 C3 D5 7F B1 2B 80 80 40 40 FF 09 1B 00 BF FF 01 44 0A 00 FF 19 F1 8B 91 85 B1 0B 7F 28 09 20 20 FC FC 11 3C 20 20 31 78 C3 7F 30 15 30 04 04 1A 1A 7F 62 D1 8B 09 C0 C0 20 20 91 8B 16 16 7F 58 FF D1 8D 11 18 7F 0D BB 87 FF 2D F7 27 D3 89 9F 01 E0 F5 8F 5F 1F FB 6D 04 04 18 18 60 7F 60 9F 01 B9 0D FF 07 37 9D D1 0D FF 35 F7 83 30 44 44 7F 19 FB 31 10 10 11 11 C3 9F 01 F5 6F F8 F8 88 88 FF 07 F9 0B C0 FF 6F 0F 00";
        byte[] bytes = Utils.hexStringToByteArray(data);
        System.out.println(bytes.length);
        LzDecompressor decompressor = new LzDecompressor();
        decompressor.decompressData(bytes, 0, null, true);
        byte[] decompressedData = decompressor.getDecompressedData();
        String expectedS = "00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 01 01 01 01 01 01 01 02 02 04 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0A 0A 05 05 00 00 FE FE 08 08 08 08 08 08 10 10 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 40 40 3F 3F 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 01 01 01 C1 C1 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 80 80 80 80 80 80 80 80 00 00 10 10 08 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 7F 7F 00 00 00 00 FF FF 04 04 04 04 04 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 20 20 91 91 41 41 2F 2F E1 E1 01 01 01 01 01 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 1A 1A 15 15 10 10 FF FF 10 10 10 10 10 10 10 10 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 01 06 06 1A 1A 62 62 02 02 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 20 20 C3 C3 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 82 82 02 02 04 04 04 04 08 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 04 04 04 04 04 04 1E 1E 04 04 04 04 04 04 06 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 FE FE 82 82 82 82 FE FE 88 88 AA AA AA AA BE BE 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 02 02 02 02 02 02 1F 1F 02 02 02 02 02 02 1F 1F 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 10 10 10 10 10 FE FE 10 10 10 10 10 10 FE FE 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 04 04 04 04 1F 1F 04 04 04 04 04 04 0A 0A 0A 0A 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 44 44 48 48 FE FE 50 50 D0 D0 7C 7C 50 50 50 50 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0F 0F 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 FC FC 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 10 20 20 40 40 80 80 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 02 02 02 02 03 03 0C 0C 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 08 08 1C 1C E4 E4 04 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 04 04 08 08 08 08 10 10 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 02 02 02 02 02 02 02 02 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 03 03 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 10 60 60 80 80 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 1C 1C 00 00 01 01 01 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 88 88 CA CA 4A 4A 7E 7E 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 02 02 02 02 04 04 08 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 10 10 10 10 10 10 10 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0A 0A 15 15 17 17 01 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 7C 7C 50 50 50 50 7E 7E 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 1F 1F 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 FE FE 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 07 07 01 01 00 00 0F 0F 00 00 03 03 02 02 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 40 40 FC FC 10 10 A0 A0 FE FE 00 00 F8 F8 08 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0D 0D 03 03 01 01 03 03 0D 0D 00 00 0F 0F 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 40 40 F6 F6 18 18 F0 F0 18 18 F6 F6 40 40 FE FE 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 08 08 0F 0F 12 12 04 04 0F 0F 08 08 0B 0B 08 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 20 20 BE BE 48 48 10 10 FC FC 04 04 F4 F4 04 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 04 04 02 02 0F 0F 00 00 07 07 00 00 0F 0F 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 10 20 20 F8 F8 80 80 F0 F0 80 80 F8 F8 80 80 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 1F 1F 00 00 07 07 04 04 04 04 07 07 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 80 80 80 80 FC FC 00 00 F0 F0 10 10 10 10 F0 F0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0F 0F 00 00 08 08 04 04 04 04 00 00 1F 1F 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 F8 F8 80 80 88 88 88 88 90 90 80 80 FC FC 80 80 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 03 03 02 02 02 02 03 03 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 F8 F8 08 08 08 08 F8 F8 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 01 02 02 0C 0C 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 E0 E0 50 50 48 48 46 46 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0B 0B 0A 0A 0B 0B 08 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 F4 F4 14 14 F4 F4 0C 0C 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 1F 1F 01 01 06 06 18 18 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 FC FC 40 40 30 30 0C 0C 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 04 04 04 04 09 09 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 80 80 90 90 88 88 88 88 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 80 80 80 80 80 80 80 80 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 08 08 08 08 08 08 7F 7F 04 04 04 04 04 04 7F 7F 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 C0 C0 01 01 01 01 01 01 E6 E6 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 3C 3C C8 C8 90 90 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 3F 3F 00 00 00 00 7F 7F 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 C0 C0 00 00 00 00 C1 C1 46 46 40 40 80 80 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 40 40 40 40 7C 7C C4 C4 04 04 08 08 08 08 10 10 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 04 04 04 04 0F 0F 08 08 10 10 68 68 05 05 05 05 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 C0 C0 40 40 40 40 80 80 84 84 03 03 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 FC FC 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 1F 1F 00 00 00 00 01 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 80 80 80 80 80 80 80 80 FC FC 80 80 80 80 40 40 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 04 04 04 04 04 04 04 04 04 04 04 04 04 04 04 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 04 04 44 44 44 44 44 44 44 44 44 44 44 44 44 44 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 08 08 05 05 00 00 10 10 08 08 03 03 00 00 08 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 20 20 FC FC 20 20 F8 F8 20 20 FE FE 88 88 F8 F8 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 01 02 02 04 04 1A 1A 02 02 02 02 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 80 80 C0 C0 20 20 10 10 08 08 16 16 10 10 10 10 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 80 80 40 40 40 40 40 40 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 01 06 06 18 18 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 80 80 00 00 01 01 06 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 20 20 40 40 80 80 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 02 02 04 04 18 18 60 60 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 01 02 02 04 04 18 18 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 40 40 20 20 10 10 0C 0C 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 44 44 44 44 04 04 04 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 08 08 08 08 10 10 11 11 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 88 88 F8 F8 88 88 18 18 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 02 02 04 04 04 04 08 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00";
        byte[] expected = Utils.hexStringToByteArray(expectedS);
        System.out.println(h(expected.length));
        assertArrayEquals(expected, decompressedData);
    }

    @Test
    void decompress() {
        try {
            String OUTPUT_ROM = "D:\\git\\itadaki-street-two\\roms\\work\\Itadaki Street 2 - English.sfc";
            String INPUT_ROM = "D:\\git\\itadaki-street-two\\roms\\work\\Itadaki Street 2 - Japan - extended.sfc";
            byte[] data = Files.readAllBytes(new File(INPUT_ROM).toPath());
            LzDecompressor decompressor = new LzDecompressor();
            decompressor.decompressData(data, x("11D40F"), null, false);
            /*
            byte[] decompressedData = decompressor.getDecompressedData();
            data = Files.readAllBytes(new File(OUTPUT_ROM).toPath());
            LzDecompressor decompressor2 = new LzDecompressor();
            decompressor2.decompressData(data, x("67FEB"), null, false);
            byte[] decompressedData2 = decompressor2.getDecompressedData();
            assertEquals(decompressor.getCompressedBytes(), decompressor2.getCompressedBytes());*/

            byte[] decompressedData = decompressor.getDecompressedData();
            
            
        } catch (IOException ex) {
            Logger.getLogger(LzDecompressorTest.class.getName()).log(Level.SEVERE, null, ex);
        }
    }
}